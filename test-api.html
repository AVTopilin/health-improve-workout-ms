<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout API Tester</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .endpoint { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .response { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 3px; white-space: pre-wrap; }
        input, textarea { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 3px; }
        .form-group { margin: 10px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; }
        .token-section { background: #e9ecef; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>üß™ Workout API Tester</h1>
    <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints –¥–ª—è workout backend</p>
    
    <div class="token-section">
        <h3>üîë JWT Token (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è dev —Ä–µ–∂–∏–º–∞)</h3>
        <div class="form-group">
            <label>JWT Token:</label>
            <input type="text" id="jwtToken" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JWT —Ç–æ–∫–µ–Ω –∏–∑ Keycloak (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ dev —Ä–µ–∂–∏–º–µ)" style="width: 100%;">
        </div>
        <div class="info" style="padding: 10px; margin-top: 10px;">
            <strong>–í dev —Ä–µ–∂–∏–º–µ API —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ç–æ–∫–µ–Ω–∞</strong><br>
            –ù–æ —Å —Ç–æ–∫–µ–Ω–æ–º –≤—ã –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        </div>
    </div>
    
    <div class="endpoint">
        <h3>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ endpoint</h3>
        <button onclick="testGet('/')">GET /</button>
        <div id="response1" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint</h3>
        <button onclick="testGet('/health')">GET /health</button>
        <div id="response2" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>3. –ü—Ä–æ–≤–µ—Ä–∫–∞ test endpoint</h3>
        <button onclick="testGet('/test')">GET /test</button>
        <div id="response3" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>4. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h3>
        <button onclick="testGet('/api/workouts')">GET /api/workouts</button>
        <div id="response4" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>5. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
        <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="workoutName" value="–¢–µ—Å—Ç–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞">
        </div>
        <div class="form-group">
            <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
            <textarea id="workoutDescription">–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</textarea>
        </div>
        <button onclick="createWorkout()">POST /api/workouts</button>
        <div id="response5" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>6. –ü–æ–ª—É—á–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
        <div class="form-group">
            <label>ID —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</label>
            <input type="number" id="workoutId" value="1">
        </div>
        <button onclick="testGet('/api/exercises/workout/' + document.getElementById('workoutId').value)">GET /api/exercises/workout/{id}</button>
        <div id="response6" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>7. –°–æ–∑–¥–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
        <div class="form-group">
            <label>ID —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</label>
            <input type="number" id="exerciseWorkoutId" value="1">
        </div>
        <div class="form-group">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</label>
            <input type="text" id="exerciseName" value="–ñ–∏–º –ª–µ–∂–∞">
        </div>
        <div class="form-group">
            <label>–ü–æ–¥—Ö–æ–¥—ã:</label>
            <input type="number" id="exerciseSets" value="3">
        </div>
        <div class="form-group">
            <label>–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è:</label>
            <input type="number" id="exerciseReps" value="10">
        </div>
        <div class="form-group">
            <label>–í–µ—Å (–∫–≥):</label>
            <input type="number" id="exerciseWeight" value="80.0" step="0.5">
        </div>
        <div class="form-group">
            <label>–í—Ä–µ–º—è –æ—Ç–¥—ã—Ö–∞ (—Å–µ–∫):</label>
            <input type="number" id="exerciseRestTime" value="120">
        </div>
        <div class="form-group">
            <label>–ü–æ—Ä—è–¥–æ–∫:</label>
            <input type="number" id="exerciseOrder" value="1">
        </div>
        <button onclick="createExercise()">POST /api/exercises</button>
        <div id="response7" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>8. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</h3>
        <button onclick="testGet('/api/schedule')">GET /api/schedule</button>
        <div id="response8" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>9. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–π</h3>
        <div class="form-group">
            <label>ID —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</label>
            <input type="number" id="progressionExerciseId" value="1">
        </div>
        <button onclick="testGet('/api/progressions?exerciseId=' + document.getElementById('progressionExerciseId').value)">GET /api/progressions?exerciseId={id}</button>
        <div id="response9" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>10. –ü—Ä–æ–≤–µ—Ä–∫–∞ Swagger UI</h3>
        <button onclick="window.open('http://localhost:8080/swagger-ui/index.html', '_blank')">–û—Ç–∫—Ä—ã—Ç—å Swagger UI</button>
        <div class="info" style="padding: 10px; margin-top: 10px;">
            <strong>Swagger UI –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ</strong><br>
            –ï—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ
        </div>
    </div>

    <div class="endpoint">
        <h3>11. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å JWT —Ç–æ–∫–µ–Ω–æ–º</h3>
        <button onclick="testWithJWT()">GET /api/workouts (—Å JWT)</button>
        <div class="warning" style="padding: 10px; margin-top: 10px;">
            <strong>–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å JWT —Ç–æ–∫–µ–Ω–æ–º</strong><br>
            –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ Keycloak, –∑–∞—Ç–µ–º –≤—Å—Ç–∞–≤—å—Ç–µ –µ–≥–æ –≤ –ø–æ–ª–µ –≤—ã—à–µ
        </div>
        <div id="response11" class="response"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';

        function getHeaders() {
            const headers = { 'Content-Type': 'application/json' };
            const token = document.getElementById('jwtToken').value.trim();
            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            }
            return headers;
        }

        async function testGet(endpoint) {
            const responseDiv = getResponseDiv(endpoint);
            responseDiv.className = 'response info';
            responseDiv.textContent = '–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...';
            
            try {
                const response = await fetch(API_BASE + endpoint, {
                    headers: getHeaders()
                });
                if (response.ok) {
                    const data = await response.json();
                    responseDiv.className = 'response success';
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    responseDiv.className = 'response error';
                    responseDiv.textContent = `–û—à–∏–±–∫–∞ ${response.status}: ${response.statusText}`;
                }
            } catch (error) {
                responseDiv.className = 'response error';
                responseDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        async function createWorkout() {
            const workoutData = {
                name: document.getElementById('workoutName').value,
                description: document.getElementById('workoutDescription').value
            };

            const responseDiv = document.getElementById('response5');
            responseDiv.className = 'response info';
            responseDiv.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏...';

            try {
                const response = await fetch(API_BASE + '/api/workouts', {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify(workoutData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    responseDiv.className = 'response success';
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    responseDiv.className = 'response error';
                    responseDiv.textContent = `–û—à–∏–±–∫–∞ ${response.status}: ${response.statusText}`;
                }
            } catch (error) {
                responseDiv.className = 'response error';
                responseDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        async function createExercise() {
            const exerciseData = {
                workoutId: parseInt(document.getElementById('exerciseWorkoutId').value),
                name: document.getElementById('exerciseName').value,
                sets: parseInt(document.getElementById('exerciseSets').value),
                reps: parseInt(document.getElementById('exerciseReps').value),
                weight: parseFloat(document.getElementById('exerciseWeight').value),
                restTime: parseInt(document.getElementById('exerciseRestTime').value),
                exerciseOrder: parseInt(document.getElementById('exerciseOrder').value),
                notes: '–¢–µ—Å—Ç–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ'
            };

            const responseDiv = document.getElementById('response7');
            responseDiv.className = 'response info';
            responseDiv.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è...';

            try {
                const response = await fetch(API_BASE + '/api/exercises', {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify(exerciseData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    responseDiv.className = 'response success';
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    responseDiv.className = 'response error';
                    responseDiv.textContent = `–û—à–∏–±–∫–∞ ${response.status}: ${response.statusText}`;
                }
            } catch (error) {
                responseDiv.className = 'response error';
                responseDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        async function testWithJWT() {
            const responseDiv = document.getElementById('response11');
            const token = document.getElementById('jwtToken').value.trim();
            
            if (!token) {
                responseDiv.className = 'response warning';
                responseDiv.textContent = '–°–Ω–∞—á–∞–ª–∞ –≤—Å—Ç–∞–≤—å—Ç–µ JWT —Ç–æ–∫–µ–Ω –≤ –ø–æ–ª–µ –≤—ã—à–µ!';
                return;
            }

            responseDiv.className = 'response info';
            responseDiv.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å JWT —Ç–æ–∫–µ–Ω–æ–º...';

            try {
                const response = await fetch(API_BASE + '/api/workouts', {
                    headers: getHeaders()
                });
                
                if (response.ok) {
                    const data = await response.json();
                    responseDiv.className = 'response success';
                    responseDiv.textContent = `‚úÖ JWT —Ç–æ–∫–µ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç!\n\n–û—Ç–≤–µ—Ç:\n${JSON.stringify(data, null, 2)}`;
                } else {
                    responseDiv.className = 'response error';
                    responseDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ —Å JWT —Ç–æ–∫–µ–Ω–æ–º: ${response.status} ${response.statusText}`;
                }
            } catch (error) {
                responseDiv.className = 'response error';
                responseDiv.textContent = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        function getResponseDiv(endpoint) {
            const endpointNumber = endpoint.replace(/\//g, '').replace(/api/g, '') || 'root';
            const responseDiv = document.getElementById('response' + endpointNumber.replace(/\D/g, ''));
            return responseDiv || document.getElementById('response1');
        }
    </script>
</body>
</html>
